clear
format long;
data001 = importdata("../../../../Documents/PartIILogs/PureGit/single_throughput_pure_git_001.log", ' ');
data07 = importdata("../../../../Documents/PartIILogs/PureGit/single_throughput_pure_git_007.log", ' ');
data01 = importdata("../../../../Documents/PartIILogs/PureGit/single_throughput_pure_git_01.log", ' ');

data = [data001 ; data07 ; data01];

latencies = ones(3,5000);
index = 0;
last_rate = -1;
for i=1:length(data)
    rate = data(i,3);
    if rate ~= last_rate
        index = index + 1;
        latencies(index,1) = (data(i,2) - data(i,1));
        last_rate = rate;
    else 
        if index <
        new = [latencies(index,:) (data(i,2) - data(i,1))]
        latencies(index) = new;
    end
end

n = 70;
figure
throughputs = [70 13 10];
hold on
for i = 1:length(throughputs) 
    lat = latencies(i, 1:5000);
    s1 = size(lat, 1);
    M  = s1 - mod(s1, n);
    y  = reshape(lat(1:M), n, []);
    lat = transpose(sum(y, 1) / n);
    
    plot((1:length(lat)) * n, lat);
end
hold off

xlabel("Blockchain size");
ylabel("Latency");
